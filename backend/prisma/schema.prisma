generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
}

model Role {
  id              Int              @id @default(autoincrement())
  name            String           @unique
  description     String?
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  rolePermissions RolePermissions?
  users           User[]
}

model Menu {
  id            Int              @id @default(autoincrement())
  title         String           @unique
  icon          String?
  url           String?
  isCollapsible Boolean          @default(false)
  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt
  roleMenus     RoleMenuAccess[]
  subMenus      SubMenu[]
}

model SubMenu {
  id           Int                 @id @default(autoincrement())
  title        String
  url          String
  menuId       Int
  createdAt    DateTime            @default(now())
  updatedAt    DateTime            @updatedAt
  roleSubMenus RoleSubMenuAccess[]
  menu         Menu                @relation(fields: [menuId], references: [id])

  @@index([menuId], map: "SubMenu_menuId_fkey")
}

model RolePermissions {
  id        Int              @id @default(autoincrement())
  roleId    Int              @unique
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt
  menus     RoleMenuAccess[]
  role      Role             @relation(fields: [roleId], references: [id])
}

model RoleMenuAccess {
  id                Int                 @id @default(autoincrement())
  rolePermissionsId Int
  menuId            Int
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  menu              Menu                @relation(fields: [menuId], references: [id])
  rolePermissions   RolePermissions     @relation(fields: [rolePermissionsId], references: [id])
  subMenus          RoleSubMenuAccess[]

  @@unique([rolePermissionsId, menuId])
  @@index([menuId], map: "RoleMenuAccess_menuId_fkey")
}

model RoleSubMenuAccess {
  id               Int            @id @default(autoincrement())
  roleMenuAccessId Int
  subMenuId        Int
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
  roleMenuAccess   RoleMenuAccess @relation(fields: [roleMenuAccessId], references: [id])
  subMenu          SubMenu        @relation(fields: [subMenuId], references: [id])

  @@unique([roleMenuAccessId, subMenuId])
  @@index([subMenuId], map: "RoleSubMenuAccess_subMenuId_fkey")
}

model User {
  id        Int       @id @default(autoincrement())
  fullName  String
  email     String    @unique
  phone     String?
  password  String
  status    String    @default("active")
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  roleId    Int
  gender    String?
  photo     String?
  employee  Employee?
  role      Role      @relation(fields: [roleId], references: [id])

  @@index([roleId], map: "User_roleId_fkey")
}

model Employee {
  id           Int        @id @default(autoincrement())
  employeeCode String     @unique
  address      String?
  dob          DateTime?
  status       String     @default("active")
  departmentId Int
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  title        String?
  userId       Int        @unique
  department   Department @relation(fields: [departmentId], references: [id])
  user         User       @relation(fields: [userId], references: [id])

  @@index([departmentId], map: "Employee_departmentId_fkey")
}

model Department {
  id             Int        @id @default(autoincrement())
  departmentName String     @unique
  description    String?
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
  employees      Employee[]
}
